# Solana Solang Integration - Quick Start Guide

## Overview
The FORGE platform now uses Solang-compiled Solidity smart contracts on Solana instead of Anchor. The frontend uses pure `@solana/web3.js` without Anchor framework overhead, resulting in simpler code and smaller bundle size.

## Testing the Integration

### 1. Start the Development Server
```bash
cd /mnt/Basefiles/Forge/frontend
npm run dev
```

The app will be available at `http://localhost:3000`

### 2. Connect Your Wallet
- Navigate to the token creator
- Select **Solana** network (should be default)
- Click "Connect Wallet"
- Choose your preferred wallet (Phantom, MetaMask, etc.)
- Approve the connection

### 3. Create a Test Token
Fill in the form with:
- **Token Name**: `TestToken` (or any name)
- **Symbol**: `TEST` (4 chars max)
- **Decimals**: `9` (or 6, 8, 18)
- **Initial Supply**: `1000` (or any amount)

Click **"Create Token"** and watch the console for detailed logs.

### 4. Monitor Transaction
The transaction signature will appear in:
- Console logs (browser DevTools)
- Success message in the UI
- Solana Devnet Explorer: https://explorer.solana.com?cluster=devnet

### 5. Verify Token Creation
Token will be created with:
- **Program ID**: `9FaWqbx7CXFPmp2SQbjiJqcGA13BggABJLyL7LS7xKZn`
- **Mint Address**: Generated by transaction
- **Token Config**: Stored in program state
- **Owner**: Your wallet address

## Troubleshooting

### "Program not found" Error
- Check: https://explorer.solana.com/address/9FaWqbx7CXFPmp2SQbjiJqcGA13BggABJLyL7LS7xKZn?cluster=devnet
- If red (not found), devnet may have reset - request new airdrop and redeploy

### Wallet Connection Issues
- Clear browser cache and local storage
- Disconnect and reconnect wallet
- Check wallet is on Solana devnet (not mainnet)

### Transaction Failures
- Check wallet has SOL balance (> 0.5 SOL for account creation)
- Request airdrop: `solana airdrop 2 <wallet> --url devnet`
- Check console logs for specific error messages

### Instruction Encoding Errors
These are unlikely but check:
- Program ID in `.env.local` matches deployed program
- Function selector (4 bytes) matches: `0x5af47d2a`
- Token name/symbol within limits (32/10 chars)
- Decimals in valid range (1-18)

## Running Tests

### Connection & Encoding Test
```bash
cd /mnt/Basefiles/Forge/frontend
node test-solana-web3.js
```

Expected output:
```
✓ Connected to Solana Devnet
✓ Program ID: 9FaWqbx7CXFPmp2SQbjiJqcGA13BggABJLyL7LS7xKZn
✓ Program found on chain
✓ Instruction encoding successful
✅ All tests passed!
```

### Integration Validation
```bash
cd /mnt/Basefiles/Forge
node validate-integration.js
```

Expected output:
```
✅ ALL CHECKS PASSED - Ready for production deployment!
```

### Build Verification
```bash
cd /mnt/Basefiles/Forge/frontend
npm run build
```

Expected output:
```
✓ Compiled successfully
Route (pages)                              Size
┌ ○ / (977 ms)                             171 kB
```

## Architecture Details

### Solang Program Functions
1. **createToken()**
   - Creates new SPL token mint
   - Stores token config in program state
   - Validates decimals (≤ 9) and name/symbol lengths
   - Emits TokenCreated event

2. **mintTokens()** (future)
   - Mint additional tokens
   - Owner-only
   - Requires token config account

3. **burnTokens()** (future)
   - Burn existing tokens
   - Owner-only
   - Requires token config account

### Instruction Encoding (Solang)
The createToken call encodes:
```
[Function Selector: 4 bytes]
[Payer PubKey: 32 bytes]
[TokenConfig PubKey: 32 bytes]
[Mint PubKey: 32 bytes]
[OwnerTokenAccount PubKey: 32 bytes]
[Name: 4-byte length + UTF-8 string]
[Symbol: 4-byte length + UTF-8 string]
[Decimals: 1 byte]
[Initial Supply: 8 bytes]
```

### Web3.js Client
Located at: `/mnt/Basefiles/Forge/frontend/lib/solana-web3-client.ts`

**Key Methods**:
```typescript
class SolanaForgeClient {
  constructor(provider: { wallet: WalletAdapter })
  async createToken(params: CreateTokenParams): Promise<string>
  getConnection(): Connection
  connectWallet(provider: any): void
}
```

## Migration from Anchor
Old approach (Anchor):
```typescript
// Complex discriminator calculation (8 bytes)
// Anchor-specific instruction layout
// Complex account validation
// Framework overhead in bundle
```

New approach (Solang + Web3.js):
```typescript
// Simple function selector (4 bytes: 0x5af47d2a)
// Direct instruction encoding
// Manual account management (simpler for devs)
// Minimal bundle impact
```

## File Structure
```
/mnt/Basefiles/Forge/
├── contracts/solana/
│   ├── programs/
│   │   └── forge_solana.sol          ← Solidity source
│   └── ForgeSolana.so                ← Compiled BPF binary
├── frontend/
│   ├── lib/
│   │   └── solana-web3-client.ts     ← Web3.js client
│   ├── components/
│   │   └── CreateTokenForm.tsx       ← Updated to use new client
│   ├── .env.local                    ← Program ID configured
│   ├── test-solana-web3.js           ← Connection test
│   └── validate-integration.js       ← Validation script
└── SOLANG_INTEGRATION.md             ← Full documentation
```

## Environment Variables
```
# .env.local
NEXT_PUBLIC_SOLANA_PROGRAM_ID=9FaWqbx7CXFPmp2SQbjiJqcGA13BggABJLyL7LS7xKZn
NEXT_PUBLIC_SOLANA_RPC=https://api.devnet.solana.com
NEXT_PUBLIC_CRONOS_FACTORY_ADDRESS=0x5c794C6C26c59535F00cCdD25bEB75b4f6D7F95e
```

## Known Limitations
- Token Verifier not yet extended for Solana
- Batch operations not yet implemented
- Event parsing not yet in frontend
- mintTokens/burnTokens UI not yet wired

## Success Criteria for Testing
- ✅ Frontend builds without errors
- ✅ Wallet connects successfully
- ✅ Token creation form renders
- ✅ Transaction submits and confirms
- ✅ Token address returned
- ✅ No "InstructionFallbackNotFound" errors
- ✅ Cronos tokens still create successfully

## Support
For issues:
1. Check browser console logs (Ctrl+Shift+K or Cmd+Option+K)
2. Review transaction on Solana Explorer
3. Check program state: `solana account 9FaWqbx7CXFPmp2SQbjiJqcGA13BggABJLyL7LS7xKZn --url devnet`
4. Verify wallet has sufficient SOL for account creation fees

---

**Program ID**: `9FaWqbx7CXFPmp2SQbjiJqcGA13BggABJLyL7LS7xKZn`  
**Network**: Solana Devnet  
**Framework**: Solang → BPF + Web3.js  
**Status**: ✅ Ready for Testing
